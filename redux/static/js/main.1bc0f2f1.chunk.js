(this["webpackJsonpredux-course"]=this["webpackJsonpredux-course"]||[]).push([[0],{15:function(e,t,n){e.exports=n(27)},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),l=n.n(c),o=n(3),i=n(2),s=n(1),u=n(9);function m(e,t){var n=[];return e.forEach((function(e){new Date(1e3*e.date).getFullYear()===t&&n.push(e)})),n.sort((function(e,t){return t.likes.count-e.likes.count})),n}var d=[],f=!1;function g(e,t,n){if(f){var a=m(d,e);t(a)}else!function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,r=200;VK.Api.call("photos.getAll",{extended:1,count:r,offset:t,v:"5.80"},(function(r){var c=r.response;try{d=[].concat(Object(u.a)(d),Object(u.a)(c.items)),t<=c.count?e(t+=200,n,a):n()}catch(l){a(new Error(l))}}))}(0,(function(){var n=m(d,e);f=!0,t(n)}),(function(e){n(e)}))}function v(e){return function(t){t({type:"GET_PHOTOS_REQUEST",payload:e}),g(e,(function(e){t({type:"GET_PHOTOS_SUCCESS",payload:e})}),(function(e){t({type:"GET_PHOTOS_FAIL",error:!0,payload:e})}))}}var h=function(){return(new Date).getFullYear()},E={year:h(),photos:[],isFetching:!1,error:""};var p={name:"",error:"",isFetching:!1};var b=Object(i.c)({page:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_PHOTOS_REQUEST":return Object(s.a)({},e,{year:t.payload,isFetching:!0,error:""});case"GET_PHOTOS_SUCCESS":return Object(s.a)({},e,{photos:t.payload,isFetching:!1,error:""});case"GET_PHOTOS_FAIL":return Object(s.a)({},e,{error:t.payload.message,isFetching:!1});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_REQUEST":return Object(s.a)({},e,{isFetching:!0,error:""});case"LOGIN_SUCCESS":return Object(s.a)({},e,{isFetching:!1,name:t.payload});case"LOGIN_FAIL":return Object(s.a)({},e,{isFetching:!1,error:t.payload.message});default:return e}}}),y=n(13),O=n.n(y),_=n(14),N=Object(i.d)(b,Object(i.a)(_.a,O.a));n(25);var S=function(e){var t=e.children,n=e.active,a=e.disabled,c=e.onClick,l=["btn"];return l.push(n?"btn-primary":"btn-secondary"),r.a.createElement("button",{className:l.join(" "),disabled:a,onClick:c},t)};function k(e){var t=e.name,n=e.error,a=e.isFetching,c=e.handleLogin;return r.a.createElement("div",{className:"user py-4"},n?r.a.createElement("p",null,"\u0412\u043e \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430, \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"):a?r.a.createElement("p",null,"\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u044e..."):t?r.a.createElement("p",null,"\u041f\u0440\u0438\u0432\u0435\u0442, ",t,"!"):r.a.createElement(S,{onClick:c,active:!0},"\u0412\u043e\u0439\u0442\u0438"))}var j=Object(o.b)((function(e){return{user:e.user}}),(function(e){return{handleLogin:function(t){return e(function(e){return function(t){t({type:"LOGIN_REQUEST"}),VK.Auth.login((function(n){if(n.session){var a=n.session.user.first_name;t({type:"LOGIN_SUCCESS",payload:a}),e&&"function"===typeof e&&e()}else t({type:"LOGIN_FAIL",error:!0,payload:new Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438")})}),4)}}(t))},getPhotos:function(t){return e(v(t))}}}))((function(e){return r.a.createElement(k,Object.assign({},e.user,{handleLogin:function(){e.handleLogin((function(){var t=h();e.getPhotos(t)}))}}))})),C=n(5);var w=function(e){var t=e.id,n=e.preview,a=e.likes,c=e.onClick;return r.a.createElement("div",{className:"photo",onClick:function(){c(t)}},r.a.createElement("p",null,r.a.createElement("img",{src:n,alt:""})),r.a.createElement("p",null,a," \u2764"))};n(26);var F=function(e){var t=e.gallery,n=e.startId,c=e.onClose,l=t.findIndex((function(e){return e.id===n})),o=Object(a.useState)(-1===l?0:l),i=Object(C.a)(o,2),s=i[0],u=i[1];return r.a.createElement(r.a.Fragment,null,-1===s?null:r.a.createElement("div",{className:"lightbox"},r.a.createElement("div",{className:"lightbox__close",onClick:c},"\xd7"),r.a.createElement("div",{className:"lightbox__prev",onClick:function(){var e=s-1;e<0&&(e=t.length-1),u(e)}},"<"),r.a.createElement("div",{className:"lightbox__next",onClick:function(){var e=s+1;e>=t.length&&(e=0),u(e)}},">"),r.a.createElement("div",{className:"lightbox__img"},r.a.createElement("div",{className:"lightbox__mask",onClick:c}),r.a.createElement("img",{src:t[s].full,alt:""}))))};var T=function(e){var t=e.photos,n=Object(a.useState)(null),c=Object(C.a)(n,2),l=c[0],o=c[1];console.log(t);var i=t.map((function(e){var t,n=(t=e.sizes,function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];for(var r=0,c=n.length;r<c;r++)for(var l=0,o=t.length;l<o;l++)if(t[l].type===n[r])return t[l].url;return null});return{preview:n("p"),full:n("w","z","y","r"),likes:e.likes.count,id:e.id}}));function s(e){o(e)}return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"gallery"},r.a.createElement("div",{className:"row"},i.map((function(e){return r.a.createElement("div",{class:"col-12 col-md-6 col-lg-4",key:e.id},r.a.createElement(w,Object.assign({},e,{onClick:s})))})))),l?r.a.createElement(F,{gallery:i,startId:l,onClose:function(){o(null)}}):null)};function x(e){var t=e.name,n=e.year,a=e.photos,c=e.getPhotos,l=e.isFetching,o=e.error,i=function(e){if(t){var n=+e.currentTarget.innerText;c(n)}},s=function(e){var t=h();return Array.from({length:e},(function(e,n){return t-n}))}(5);return r.a.createElement("div",{className:"page py-4"},r.a.createElement("div",{className:"filters btn-group mb-4"},s.map((function(e){return r.a.createElement(S,{key:e,onClick:i,disabled:!t,active:n===e},e)}))),t?r.a.createElement("h3",null,n," [",a.length,"]"):null,t?o?r.a.createElement("p",{className:"error"},"\u0412\u043e \u0432\u0440\u0435\u043c\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0444\u043e\u0442\u043e \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"):l?r.a.createElement("p",null,"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."):a.length?r.a.createElement("div",{className:"photos"},r.a.createElement(T,{photos:a})):r.a.createElement("p",null,"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0437\u0430 ",n," \u0433\u043e\u0434 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"):r.a.createElement("p",null,"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044c, \u0447\u0442\u043e\u0431\u044b \u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438"))}var I=Object(o.b)((function(e){return{page:e.page,name:e.user.name}}),(function(e){return{getPhotos:function(t){return e(v(t))}}}))((function(e){var t=e.name,n=e.page,a=e.getPhotos;return r.a.createElement(x,Object.assign({},n,{name:t,getPhotos:a}))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(o.a,{store:N},r.a.createElement((function(){return r.a.createElement("div",{className:"app"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 col-md-2 order-md-last col-lg-2 text-right"},r.a.createElement(j,null)),r.a.createElement("div",{className:"col-12 col-md-10 order-md-first col-lg-10"},r.a.createElement(I,null)))))}),null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[15,1,2]]]);
//# sourceMappingURL=main.1bc0f2f1.chunk.js.map