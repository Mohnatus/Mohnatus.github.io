{"version":3,"sources":["actions/utils/makeYearPhotos.js","actions/utils/getPhotos.js","actions/PageActions.js","util/date.js","reducers/page.js","reducers/user.js","reducers/index.js","actions/UserActions.js","store/configureStore.js","components/Button.js","components/User.js","containers/UserContainer.js","components/Photo.js","components/LightBoxGallery/LightBoxGallery.js","components/Gallery.js","components/Page.js","containers/PageContainer.js","serviceWorker.js","index.js","components/App.js"],"names":["makeYearPhotos","photos","selectedYear","yearPhotos","forEach","item","Date","date","getFullYear","push","sort","a","b","likes","count","photosArr","cached","getPhotos","year","onSuccess","onError","loadPhotos","offset","VK","Api","call","extended","v","r","response","items","e","Error","error","getPhotosByYear","dispatch","type","payload","getCurrentYear","initialState","isFetching","name","rootReducer","combineReducers","page","state","action","message","user","store","createStore","applyMiddleware","thunk","logger","Button","children","active","disabled","onClick","classes","className","join","User","handleLogin","connect","cb","Auth","login","session","username","first_name","props","Photo","id","preview","src","alt","LightBoxGallery","gallery","startId","onClose","startIndex","findIndex","photo","useState","current","setCurrent","index","length","full","Gallery","increasedId","setIncreasedId","console","log","map","sizes","getUrl","formats","k","formatsCount","i","sizesLength","url","increase","entry","class","key","Page","yearClickHandler","currentTarget","innerText","years","number","currentYear","Array","from","el","getLastYears","btnYear","Boolean","window","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch"],"mappings":"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","file":"static/js/main.1bc0f2f1.chunk.js","sourcesContent":["export function makeYearPhotos(photos, selectedYear) {\r\n\tlet createdYear,\r\n\t\tyearPhotos = [];\r\n\r\n\tphotos.forEach(item => {\r\n\t\tcreatedYear = new Date(item.date * 1000).getFullYear();\r\n\t\tif (createdYear === selectedYear) {\r\n\t\t\tyearPhotos.push(item);\r\n\t\t}\r\n\t});\r\n\r\n\tyearPhotos.sort((a, b) => b.likes.count - a.likes.count);\r\n\r\n\treturn yearPhotos;\r\n}\r\n","import { makeYearPhotos } from './makeYearPhotos';\r\n\r\nlet photosArr = [];\r\nlet cached = false;\r\n\r\n/**\r\n * Загружает фотографии из VK порциями по 200\r\n * @param {number} offset\r\n * @param {Function} onSuccess\r\n * @param {Function} onError\r\n */\r\nconst limit = 200;\r\nfunction loadPhotos(offset = 0, onSuccess, onError) {\r\n\tlet count = limit;\r\n\r\n\t//eslint-disable-next-line no-undef\r\n\tVK.Api.call('photos.getAll', { extended: 1, count, offset, v: '5.80' }, r => {\r\n\t\tconst response = r.response;\r\n\t\ttry {\r\n\t\t\tphotosArr = [...photosArr, ...response.items];\r\n\t\t\tif (offset <= response.count) {\r\n\t\t\t\toffset += limit;\r\n\t\t\t\tloadPhotos(offset, onSuccess, onError);\r\n\t\t\t} else {\r\n\t\t\t\tonSuccess();\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tonError(new Error(e));\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * Возвращает фотографии за определенный год\r\n * @param {number} year\r\n * @param {Function} onSuccess\r\n * @param {Function} onError\r\n */\r\nexport function getPhotos(year, onSuccess, onError) {\r\n\tif (cached) {\r\n\t\tconst photos = makeYearPhotos(photosArr, year);\r\n\t\tonSuccess(photos);\r\n\t\treturn;\r\n\t}\r\n\r\n\tloadPhotos(\r\n\t\t0,\r\n\t\t() => {\r\n\t\t\tlet photos = makeYearPhotos(photosArr, year);\r\n\t\t\tcached = true;\r\n\t\t\tonSuccess(photos);\r\n\t\t},\r\n\t\terror => {\r\n\t\t\tonError(error);\r\n\t\t}\r\n\t);\r\n}\r\n","/**\r\n * Действия страницы\r\n */\r\n\r\nimport { getPhotos } from './utils/getPhotos';\r\n\r\nexport const GET_PHOTOS_REQUEST = 'GET_PHOTOS_REQUEST';\r\nexport const GET_PHOTOS_SUCCESS = 'GET_PHOTOS_SUCCESS';\r\nexport const GET_PHOTOS_FAIL = 'GET_PHOTOS_FAIL';\r\n\r\n/**\r\n * Отображение фотографий по году\r\n * @param {number} year\r\n */\r\nexport function getPhotosByYear(year) {\r\n\treturn dispatch => {\r\n\t\tdispatch({\r\n\t\t\ttype: GET_PHOTOS_REQUEST,\r\n\t\t\tpayload: year,\r\n\t\t});\r\n\r\n\t\tgetPhotos(\r\n\t\t\tyear,\r\n\t\t\tphotos => {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: GET_PHOTOS_SUCCESS,\r\n\t\t\t\t\tpayload: photos,\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\terror => {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: GET_PHOTOS_FAIL,\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\tpayload: error,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t);\r\n\t};\r\n}\r\n","export const getCurrentYear = () => new Date().getFullYear();\r\n\r\nexport const getLastYears = number => {\r\n\tconst currentYear = getCurrentYear();\r\n\r\n\treturn Array.from({ length: number }, (el, i) => currentYear - i);\r\n};\r\n","import {\r\n\tGET_PHOTOS_REQUEST,\r\n\tGET_PHOTOS_SUCCESS,\r\n\tGET_PHOTOS_FAIL,\r\n} from '../actions/PageActions';\r\nimport { getCurrentYear } from '../util/date';\r\n\r\nconst initialState = {\r\n\tyear: getCurrentYear(),\r\n\tphotos: [],\r\n\tisFetching: false,\r\n\terror: '',\r\n};\r\n\r\nexport function pageReducer(state = initialState, action) {\r\n\tswitch (action.type) {\r\n\t\tcase GET_PHOTOS_REQUEST:\r\n\t\t\treturn { ...state, year: action.payload, isFetching: true, error: '' };\r\n\r\n\t\tcase GET_PHOTOS_SUCCESS:\r\n\t\t\treturn { ...state, photos: action.payload, isFetching: false, error: '' };\r\n\r\n\t\tcase GET_PHOTOS_FAIL:\r\n\t\t\treturn { ...state, error: action.payload.message, isFetching: false };\r\n\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","import {\r\n\tLOGIN_REQUEST,\r\n\tLOGIN_SUCCESS,\r\n\tLOGIN_FAIL,\r\n} from '../actions/UserActions';\r\n\r\nconst initialState = {\r\n\tname: '',\r\n\terror: '',\r\n\tisFetching: false,\r\n};\r\n\r\nexport function userReducer(state = initialState, action) {\r\n\tswitch (action.type) {\r\n\t\tcase LOGIN_REQUEST:\r\n\t\t\treturn { ...state, isFetching: true, error: '' };\r\n\r\n\t\tcase LOGIN_SUCCESS:\r\n\t\t\treturn { ...state, isFetching: false, name: action.payload };\r\n\r\n\t\tcase LOGIN_FAIL:\r\n\t\t\treturn { ...state, isFetching: false, error: action.payload.message };\r\n\r\n\t\tdefault:\r\n\t\t\treturn state;\r\n\t}\r\n}\r\n","import { combineReducers } from 'redux';\r\nimport { pageReducer } from './page';\r\nimport { userReducer } from './user';\r\n\r\nexport const rootReducer = combineReducers({\r\n\tpage: pageReducer,\r\n\tuser: userReducer,\r\n});\r\n","/**\r\n * Действия юзера\r\n */\r\n\r\nexport const LOGIN_REQUEST = 'LOGIN_REQUEST';\r\nexport const LOGIN_SUCCESS = 'LOGIN_SUCCESS';\r\nexport const LOGIN_FAIL = 'LOGIN_FAIL';\r\n\r\n/**\r\n * Авторизация через VK\r\n * @param {Function} cb\r\n */\r\nexport function handleLogin(cb) {\r\n\treturn dispatch => {\r\n\t\tdispatch({\r\n\t\t\ttype: LOGIN_REQUEST,\r\n\t\t});\r\n\r\n\t\t//eslint-disable-next-line no-undef\r\n\t\tVK.Auth.login(r => {\r\n\t\t\tif (r.session) {\r\n\t\t\t\tlet username = r.session.user.first_name;\r\n\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: LOGIN_SUCCESS,\r\n\t\t\t\t\tpayload: username,\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (cb && typeof cb === 'function') cb();\r\n\t\t\t} else {\r\n\t\t\t\tdispatch({\r\n\t\t\t\t\ttype: LOGIN_FAIL,\r\n\t\t\t\t\terror: true,\r\n\t\t\t\t\tpayload: new Error('Ошибка авторизации'),\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}, 4);\r\n\t};\r\n}\r\n","import { createStore, applyMiddleware } from 'redux';\r\nimport { rootReducer } from '../reducers';\r\n// import { ping } from './enhancers/ping';\r\nimport logger from 'redux-logger';\r\n/*\r\n * redux-thunk\r\n * https://github.com/reduxjs/redux-thunk/blob/master/src/index.js\r\n * позволяет возвращать из action creator не объект события, а функцию\r\n * которая имеет доступ к методам хранилища (dispatch, getState)\r\n */\r\nimport thunk from 'redux-thunk';\r\n\r\nexport const store = createStore(rootReducer, applyMiddleware(thunk, logger));\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nButton.propTypes = {\r\n\tactive: PropTypes.bool,\r\n\tdisabled: PropTypes.bool,\r\n\tonClick: PropTypes.func,\r\n};\r\n\r\nfunction Button({ children, active, disabled, onClick }) {\r\n\tconst classes = ['btn'];\r\n\tclasses.push(active ? 'btn-primary' : 'btn-secondary');\r\n\r\n\treturn (\r\n\t\t<button className={classes.join(' ')} disabled={disabled} onClick={onClick}>\r\n\t\t\t{children}\r\n\t\t</button>\r\n\t);\r\n}\r\n\r\nexport default Button;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Button from './Button';\r\n\r\nexport function User({ name, error, isFetching, handleLogin }) {\r\n\tconst getTemplate = () => {\r\n\t\tif (error) {\r\n\t\t\treturn <p>Во время запроса произошла ошибка, обновите страницу</p>;\r\n\t\t}\r\n\r\n\t\tif (isFetching) {\r\n\t\t\treturn <p>Загружаю...</p>;\r\n\t\t}\r\n\r\n\t\tif (name) {\r\n\t\t\treturn <p>Привет, {name}!</p>;\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<Button onClick={handleLogin} active>\r\n\t\t\t\t\tВойти\r\n\t\t\t\t</Button>\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\treturn <div className=\"user py-4\">{getTemplate()}</div>;\r\n}\r\n\r\nUser.propTypes = {\r\n\tname: PropTypes.string.isRequired,\r\n\terror: PropTypes.string,\r\n\tisFetching: PropTypes.bool.isRequired,\r\n\thandleLogin: PropTypes.func.isRequired,\r\n};\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { User } from '../components/User';\r\nimport { handleLogin } from '../actions/UserActions';\r\nimport { getPhotosByYear } from '../actions/PageActions';\r\nimport { getCurrentYear } from '../util/date';\r\n\r\nfunction UserContainer(props) {\r\n\tconst handleLogin = () => {\r\n\t\tconst cb = () => {\r\n\t\t\tconst year = getCurrentYear();\r\n\t\t\tprops.getPhotos(year);\r\n\t\t};\r\n\t\tprops.handleLogin(cb);\r\n\t};\r\n\r\n\treturn <User {...props.user} handleLogin={handleLogin} />;\r\n}\r\n\r\nconst mapStateToProps = store => {\r\n\treturn {\r\n\t\tuser: store.user,\r\n\t};\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n\treturn {\r\n\t\thandleLogin: cb => dispatch(handleLogin(cb)),\r\n\t\tgetPhotos: year => dispatch(getPhotosByYear(year)),\r\n\t};\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(UserContainer);\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nPhoto.propTypes = {\r\n\tid: PropTypes.number.isRequired,\r\n\tpreview: PropTypes.string.isRequired,\r\n\tlikes: PropTypes.number.isRequired,\r\n\tonClick: PropTypes.func.isRequired,\r\n};\r\n\r\nfunction Photo({ id, preview, likes, onClick }) {\r\n\tconst clickHandler = function() {\r\n\t\tonClick(id);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"photo\" onClick={clickHandler}>\r\n\t\t\t<p>\r\n\t\t\t\t<img src={preview} alt=\"\" />\r\n\t\t\t</p>\r\n\t\t\t<p>{likes} ❤</p>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default Photo;\r\n","import React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport './LightBoxGallery.scss';\r\n\r\nLightBoxGallery.propTypes = {\r\n\tgallery: PropTypes.array.isRequired,\r\n\tstartId: PropTypes.number.isRequired,\r\n\tonClose: PropTypes.func.isRequired,\r\n};\r\n\r\nfunction LightBoxGallery({ gallery, startId, onClose }) {\r\n\tlet startIndex = gallery.findIndex(photo => photo.id === startId);\r\n\r\n\tconst [current, setCurrent] = useState(startIndex === -1 ? 0 : startIndex);\r\n\r\n\tfunction prev() {\r\n\t\tlet index = current - 1;\r\n\t\tif (index < 0) index = gallery.length - 1;\r\n\t\tsetCurrent(index);\r\n\t}\r\n\r\n\tfunction next() {\r\n\t\tlet index = current + 1;\r\n\t\tif (index >= gallery.length) index = 0;\r\n\t\tsetCurrent(index);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{current === -1 ? null : (\r\n\t\t\t\t<div className=\"lightbox\">\r\n\t\t\t\t\t<div className=\"lightbox__close\" onClick={onClose}>\r\n\t\t\t\t\t\t&times;\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"lightbox__prev\" onClick={prev}>\r\n\t\t\t\t\t\t&lt;\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"lightbox__next\" onClick={next}>\r\n\t\t\t\t\t\t&gt;\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"lightbox__img\">\r\n\t\t\t\t\t\t<div className=\"lightbox__mask\" onClick={onClose}></div>\r\n\t\t\t\t\t\t<img src={gallery[current].full} alt=\"\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default LightBoxGallery;\r\n","import React, { useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Photo from './Photo';\r\nimport LightBoxGallery from './LightBoxGallery/LightBoxGallery';\r\n\r\nGallery.propTypes = {\r\n\tphotos: PropTypes.array.isRequired,\r\n};\r\n\r\nconst getImageByFormat = sizes => (...formats) => {\r\n\tfor (let k = 0, formatsCount = formats.length; k < formatsCount; k++) {\r\n\t\tfor (let i = 0, sizesLength = sizes.length; i < sizesLength; i++) {\r\n\t\t\tif (sizes[i].type === formats[k]) return sizes[i].url;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n};\r\n\r\nfunction Gallery({ photos }) {\r\n\tconst [increasedId, setIncreasedId] = useState(null);\r\n\tconsole.log(photos);\r\n\r\n\tconst gallery = photos.map(photo => {\r\n\t\tconst getUrl = getImageByFormat(photo.sizes);\r\n\t\treturn {\r\n\t\t\tpreview: getUrl('p'),\r\n\t\t\tfull: getUrl('w', 'z', 'y', 'r'),\r\n\t\t\tlikes: photo.likes.count,\r\n\t\t\tid: photo.id,\r\n\t\t};\r\n\t});\r\n\r\n\tfunction increase(id) {\r\n\t\tsetIncreasedId(id);\r\n\t}\r\n\r\n\tfunction closeLightBox() {\r\n\t\tsetIncreasedId(null);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<>\r\n\t\t\t<div className=\"gallery\">\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t{gallery.map(entry => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div class=\"col-12 col-md-6 col-lg-4\" key={entry.id}>\r\n\t\t\t\t\t\t\t\t<Photo {...entry} onClick={increase} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{increasedId ? (\r\n\t\t\t\t<LightBoxGallery\r\n\t\t\t\t\tgallery={gallery}\r\n\t\t\t\t\tstartId={increasedId}\r\n\t\t\t\t\tonClose={closeLightBox}\r\n\t\t\t\t/>\r\n\t\t\t) : null}\r\n\t\t</>\r\n\t);\r\n}\r\n\r\nexport default Gallery;\r\n","import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport Gallery from './Gallery';\r\nimport Button from './Button';\r\nimport { getLastYears } from '../util/date';\r\nexport function Page({ name, year, photos, getPhotos, isFetching, error }) {\r\n\tconst yearClickHandler = e => {\r\n\t\tif (!name) return;\r\n\t\tconst year = +e.currentTarget.innerText;\r\n\t\tgetPhotos(year);\r\n\t};\r\n\r\n\tconst getTemplate = () => {\r\n\t\tif (!name) {\r\n\t\t\treturn <p>Авторизуйтесь, чтобы смотреть фотографии</p>;\r\n\t\t}\r\n\r\n\t\tif (error) {\r\n\t\t\treturn <p className=\"error\">Во время загрузки фото произошла ошибка</p>;\r\n\t\t}\r\n\r\n\t\tif (isFetching) {\r\n\t\t\treturn <p>Загрузка...</p>;\r\n\t\t}\r\n\r\n\t\tif (!photos.length) {\r\n\t\t\treturn <p>Изображения за {year} год не найдены</p>;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"photos\">\r\n\t\t\t\t<Gallery photos={photos} />\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst years = getLastYears(5);\r\n\r\n\treturn (\r\n\t\t<div className=\"page py-4\">\r\n\t\t\t<div className=\"filters btn-group mb-4\">\r\n\t\t\t\t{years.map(btnYear => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tkey={btnYear}\r\n\t\t\t\t\t\t\tonClick={yearClickHandler}\r\n\t\t\t\t\t\t\tdisabled={!name}\r\n\t\t\t\t\t\t\tactive={year === btnYear}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{btnYear}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t\t{name ? (\r\n\t\t\t\t<h3>\r\n\t\t\t\t\t{year} [{photos.length}]\r\n\t\t\t\t</h3>\r\n\t\t\t) : null}\r\n\r\n\t\t\t{getTemplate()}\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nPage.propTypes = {\r\n\tyear: PropTypes.number.isRequired,\r\n\tphotos: PropTypes.array.isRequired,\r\n\tgetPhotos: PropTypes.func.isRequired,\r\n};\r\n","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Page } from '../components/Page';\r\nimport { getPhotosByYear } from '../actions/PageActions';\r\n\r\nfunction PageContainer({ name, page, getPhotos }) {\r\n\treturn <Page {...page} name={name} getPhotos={getPhotos} />;\r\n}\r\n\r\nconst mapStateToProps = store => {\r\n\treturn {\r\n\t\tpage: store.page,\r\n\t\tname: store.user.name,\r\n\t};\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n\treturn {\r\n\t\tgetPhotos: year => dispatch(getPhotosByYear(year)),\r\n\t};\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(PageContainer);\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport { Provider } from 'react-redux';\r\nimport { store } from './store/configureStore';\r\n\r\nimport './index.scss';\r\n\r\nimport App from './components/App';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nReactDOM.render(\r\n\t<Provider store={store}>\r\n\t\t<App />\r\n\t</Provider>,\r\n\tdocument.getElementById('root')\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n","import React from 'react';\r\nimport UserContainer from '../containers/UserContainer';\r\nimport PageContainer from '../containers/PageContainer';\r\n\r\nexport default function App() {\r\n\treturn (\r\n\t\t<div className=\"app\">\r\n\t\t\t<div className=\"container\">\r\n\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t<div className=\"col-12 col-md-2 order-md-last col-lg-2 text-right\">\r\n\t\t\t\t\t\t<UserContainer />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"col-12 col-md-10 order-md-first col-lg-10\">\r\n\t\t\t\t\t\t<PageContainer />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"sourceRoot":""}